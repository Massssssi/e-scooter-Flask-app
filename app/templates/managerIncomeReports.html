<!-- This is where the manager can see all of the information on company income etc. -->

{% extends "baseEmployeeManager.html" %}
  <div class="block_content">
    {% block content %}

    <h1>Passive income</h1>

    <form method="post", action="">
      {{ form.hidden_tag() }}

        Please select a start date: {{ form.date(class_='form-control') }}
        {% for error in form.date.errors %}
        <span class="warning">[{{ error }}]</span>
        {% endfor %}<br>

        <input type="submit" class="button" value="Submit">
    </form>

    {% if result %}
    <h5>For the whole week:</h5>
    <table border="1">
      <tr>
        <td>Hire length</td>
        <td>No. of session</td>
        <td>Total income</td>
        <td>Ranking of popularity</td>
      </tr>
      <tr>
        <td>One hour</td>
        <td>{{ result[0][0] }}</td>
        <td>{{ result[0][1] }}</td>
        <td>{{ rank[0] }}</td>
      </tr>
      <tr>
        <td>Four hour</td>
        <td>{{ result[1][0] }}</td>
        <td>{{ result[1][1] }}</td>
        <td>{{ rank[1] }}</td>
      </tr>
      <tr>
        <td>One day</td>
        <td>{{ result[2][0] }}</td>
        <td>{{ result[2][1] }}</td>
        <td>{{ rank[2] }}</td>
      </tr>
      <tr>
        <td>One week</td>
        <td>{{ result[3][0] }}</td>
        <td>{{ result[3][1] }}</td>
        <td>{{ rank[3] }}</td>
      </tr>
      <tr>
        <td>Other (extended)</td>
        <td>{{ result[4][0] }}</td>
        <td>{{ result[4][1] }}</td>
        <td>{{ rank[4] }}</td>
      </tr>
    </table>

    </br>
    <h5>Number of session on each day:</h5>
    <table border="1">
      <tr>
        <td>Date</td>
        <td>Weekday</td>
        <td>One hour</td>
        <td>Four hour</td>
        <td>One day</td>
        <td>One week</td>
        <td>Other (extended)</td>
        <td>Total</td>
      </tr>
      {% for i in range(7) %}
      <tr>
        <td>{{ labels[i] }}</td>
        <td>{{ wd[i] }}</td>
        <td>{{ v1[i*5] }}</td>
        <td>{{ v1[i*5+1] }}</td>
        <td>{{ v1[i*5+2] }}</td>
        <td>{{ v1[i*5+3] }}</td>
        <td>{{ v1[i*5+4] }}</td>
        <td>{{ v1[i*5] + v1[i*5+1] + v1[i*5+2] + v1[i*5+3] + v1[i*5+4] }}</td>
      </tr>
      {% endfor %}
    </table>

      <canvas id="chart" width="600" height="400"></canvas>
      <script>
            // bar chart data
            var barData = {
              type: "Bar",
              labels : [
                {% for item in labels %}
                 "{{ item }}",
                {% endfor %}
      	       ],

              datasets : [{
                label: "One hour",
                fillColor: "rgba(0,187,205,0.2)",
                strokeColor: "rgba(0,187,205,1)",
                data : [
                  {% for i in range(7) %}
                     "{{ v0[i*5] }}",
                    {% endfor %}
      	           ]
                },
                {
                  fillColor: "rgba(200,100,285,0.2)",
                  strokeColor: "rgba(200,100,285,1)",
                  data : [
                    {% for i in range(7) %}
                       "{{ v0[i*5+1] }}",
                      {% endfor %}
        	           ]
                  },
                  {
                    fillColor: "rgba(151,187,0,0.2)",
                    strokeColor: "rgba(151,187,0,1)",
                    data : [
                      {% for i in range(7) %}
                         "{{ v0[i*5+2] }}",
                        {% endfor %}
          	        ]
                  },
                  {
                    fillColor: "rgba(200,100,100,0.2)",
                    strokeColor: "rgba(200,100,100,1)",
                    data : [
                      {% for i in range(7) %}
                         "{{ v0[i*5+3] }}",
                        {% endfor %}
                    ]
                  },
                  {
                    fillColor: "rgba(100,100,200,0.2)",
                    strokeColor: "rgba(100,100,200,1)",
                    data : [
                      {% for i in range(7) %}
                         "{{ v0[i*5+4] }}",
                        {% endfor %}
                    ]
                  }
                ]
              }

           // get bar chart canvas
           var mychart = document.getElementById("chart").getContext("2d");

             max = {{ max }}
             steps = Math.ceil(max/100)*10

           // draw bar chart
           new Chart(mychart).Bar(barData, {
             scaleOverride: true,
             scaleSteps: Math.ceil(max / steps),
             scaleStepWidth: steps,
             scaleStartValue: 0,
             scaleShowVerticalLines: true,
             scaleShowGridLines : true,
             barShowStroke : true,
             scaleShowLabels: true,

             title: {
               display: true,
               text: 'Population growth (millions)'
             }
           });

          </script>
    </center>

    {% endif %}
    {% endblock %}
  </div>
